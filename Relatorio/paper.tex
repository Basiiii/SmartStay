% This template has been tested with LLNCS DOCUMENT CLASS -- version 2.21 (12-Jan-2022)

% !TeX spellcheck = pt_PT-Portuguese
% !LTeX: language= pt_PT-Portuguese
% !TeX encoding = utf8
% !TeX program = pdflatex
% !BIB program = bibtex
% -*- coding:utf-8 mod:LaTeX -*-

% "a4paper" enables:
%
%  - easy print out on DIN A4 paper size
%
% One can configure a4 vs. letter in the LaTeX installation. So it is configuration dependend, what the paper size will be.
% This option  present, because the current word template offered by Springer is DIN A4.
% We accept that DIN A4 cause WTFs at persons not used to A4 in USA.
%
% "runningheads" enables:
%
%  - page number on page 2 onwards
%  - title/authors on even/odd pages
%
% This is good for other readers to enable proper archiving among other papers and pointing to
% content. Even if the title page states the title, when printed and stored in a folder, when
% blindly opening the folder, one could hit not the title page, but an arbitrary page. Therefore,
% it is good to have title printed on the pages, too.
%
% To disable outputting page headers and footers, remove "runningheads"
\documentclass[runningheads,a4paper,english]{llncs}[2022/01/12]

% backticks (`) are rendered as such in verbatim environments.
% See following links for details:
%   - https://tex.stackexchange.com/a/341057/9075
%   - https://tex.stackexchange.com/a/47451/9075
%   - https://tex.stackexchange.com/a/166791/9075
\usepackage{upquote}

% Used to add images
\usepackage{graphicx}

% Used for figures
\usepackage{float}

% Set English as language and allow to write hyphenated"=words
%
% Even though `american`, `english` and `USenglish` are synonyms for babel package (according to https://tex.stackexchange.com/questions/12775/babel-english-american-usenglish), the llncs document class is prepared to avoid the overriding of certain names (such as "Abstract." -> "Abstract" or "Fig." -> "Figure") when using `english`, but not when using the other 2.
% english has to go last to set it as default language
\usepackage[ngerman,main=english]{babel}
%
% Hint by http://tex.stackexchange.com/a/321066/9075 -> enable "= as dashes
\addto\extrasenglish{\languageshorthands{ngerman}\useshorthands{"}}
%
% Fix by https://tex.stackexchange.com/a/441701/9075
\usepackage{regexpatch}
\makeatletter
\edef\switcht@albion{%
  \relax\unexpanded\expandafter{\switcht@albion}%
}
\xpatchcmd*{\switcht@albion}{ \def}{\def}{}{}
\xpatchcmd{\switcht@albion}{\relax}{}{}{}
\edef\switcht@deutsch{%
  \relax\unexpanded\expandafter{\switcht@deutsch}%
}
\xpatchcmd*{\switcht@deutsch}{ \def}{\def}{}{}
\xpatchcmd{\switcht@deutsch}{\relax}{}{}{}
\edef\switcht@francais{%
  \relax\unexpanded\expandafter{\switcht@francais}%
}
\xpatchcmd*{\switcht@francais}{ \def}{\def}{}{}
\xpatchcmd{\switcht@francais}{\relax}{}{}{}
\makeatother

% Links behave as they should. Enables "\url{...}" for URL typesettings.
% Allow URL breaks also at a hyphen, even though it might be confusing: Is the "-" part of the address or just a hyphen?
% See https://tex.stackexchange.com/a/3034/9075.
\usepackage[hyphens]{url}

% When activated, use text font as url font, not the monospaced one.
% For all options see https://tex.stackexchange.com/a/261435/9075.
% \urlstyle{same}

% Improve wrapping of URLs - hint by http://tex.stackexchange.com/a/10419/9075
\makeatletter
\g@addto@macro{\UrlBreaks}{\UrlOrds}
\makeatother

% nicer // - solution by http://tex.stackexchange.com/a/98470/9075
% DO NOT ACTIVATE -> prevents line breaks
%\makeatletter
%\def\Url@twoslashes{\mathchar`\/\@ifnextchar/{\kern-.2em}{}}
%\g@addto@macro\UrlSpecials{\do\/{\Url@twoslashes}}
%\makeatother

% This is the modern package for "Computer Modern".
% In case this gets activated, one has to switch from cmap package to glyphtounicode (in the case of pdflatex)
\usepackage[%
    rm={oldstyle=false,proportional=true},%
    sf={oldstyle=false,proportional=true},%
    % By using 'variable=true' the monospaced font can be used as variable font (with differents widths per letter)
    % However, this makes listings look ugly.
    tt={oldstyle=false,proportional=true,variable=false},%
    qt=false%
]{cfr-lm}

% Has to be loaded AFTER any font packages. See https://tex.stackexchange.com/a/2869/9075.
\usepackage[T1]{fontenc}

% Character protrusion and font expansion. See http://www.ctan.org/tex-archive/macros/latex/contrib/microtype/

\usepackage[
  babel=true, % Enable language-specific kerning. Take language-settings from the languge of the current document (see Section 6 of microtype.pdf)
  expansion=alltext,
  protrusion=alltext-nott, % Ensure that at listings, there is no change at the margin of the listing
  final % Always enable microtype, even if in draft mode. This helps finding bad boxes quickly.
        % In the standard configuration, this template is always in the final mode, so this option only makes a difference if "pros" use the draft mode
]{microtype}

% \texttt{test -- test} keeps the "--" as "--" (and does not convert it to an en dash)
\DisableLigatures{encoding = T1, family = tt* }

%\DeclareMicrotypeSet*[tracking]{my}{ font = */*/*/sc/* }%
%\SetTracking{ encoding = *, shape = sc }{ 45 }
% Source: http://homepage.ruhr-uni-bochum.de/Georg.Verweyen/pakete.html
% Deactiviated, because does not look good

\usepackage{graphicx}

% Diagonal lines in a table - http://tex.stackexchange.com/questions/17745/diagonal-lines-in-table-cell
% Slashbox is not available in texlive (due to licensing) and also gives bad results. Thus, we use diagbox
\usepackage{diagbox}

\usepackage{xcolor}

% Code Listings
\usepackage{listings}
\usepackage{caption}

\definecolor{eclipseStrings}{RGB}{42,0.0,255}
\definecolor{eclipseKeywords}{RGB}{127,0,85}
\colorlet{numb}{magenta!60!black}

% JSON definition
% Source: https://tex.stackexchange.com/a/433961/9075

\lstdefinelanguage{json}{
    basicstyle=\normalfont\ttfamily,
    commentstyle=\color{eclipseStrings}, % style of comment
    stringstyle=\color{eclipseKeywords}, % style of strings
    numbers=left,
    numberstyle=\scriptsize,
    stepnumber=1,
    numbersep=8pt,
    showstringspaces=false,
    breaklines=true,
    frame=lines,
    % backgroundcolor=\color{gray}, %only if you like
    string=[s]{"}{"},
    comment=[l]{:\ "},
    morecomment=[l]{:"},
    literate=
        *{0}{{{\color{numb}0}}}{1}
         {1}{{{\color{numb}1}}}{1}
         {2}{{{\color{numb}2}}}{1}
         {3}{{{\color{numb}3}}}{1}
         {4}{{{\color{numb}4}}}{1}
         {5}{{{\color{numb}5}}}{1}
         {6}{{{\color{numb}6}}}{1}
         {7}{{{\color{numb}7}}}{1}
         {8}{{{\color{numb}8}}}{1}
         {9}{{{\color{numb}9}}}{1}
}

\lstset{
  % everything between (* *) is a latex command
  escapeinside={(*}{*)},
  %
  language=json,
  %
  showstringspaces=false,
  %
  extendedchars=true,
  %
  basicstyle=\footnotesize\ttfamily,
  %
  commentstyle=\slshape,
  %
  % default: \rmfamily
  stringstyle=\ttfamily,
  %
  breaklines=true,
  %
  breakatwhitespace=true,
  %
  % alternative: fixed
  columns=flexible,
  %
  numbers=left,
  %
  numberstyle=\tiny,
  %
  basewidth=.5em,
  %
  xleftmargin=.5cm,
  %
  % aboveskip=0mm,
  %
  % belowskip=0mm,
  %
  captionpos=b
}

% Enable Umlauts when using \lstinputputlisting.
% See https://stackoverflow.com/a/29260603/873282 für details.
% listingsutf8 did not work in June 2020.
\lstset{literate=
  {á}{{\'a}}1 {é}{{\'e}}1 {í}{{\'i}}1 {ó}{{\'o}}1 {ú}{{\'u}}1
  {Á}{{\'A}}1 {É}{{\'E}}1 {Í}{{\'I}}1 {Ó}{{\'O}}1 {Ú}{{\'U}}1
  {à}{{\`a}}1 {è}{{\`e}}1 {ì}{{\`i}}1 {ò}{{\`o}}1 {ù}{{\`u}}1
  {À}{{\`A}}1 {È}{{\'E}}1 {Ì}{{\`I}}1 {Ò}{{\`O}}1 {Ù}{{\`U}}1
  {ä}{{\"a}}1 {ë}{{\"e}}1 {ï}{{\"i}}1 {ö}{{\"o}}1 {ü}{{\"u}}1
  {Ä}{{\"A}}1 {Ë}{{\"E}}1 {Ï}{{\"I}}1 {Ö}{{\"O}}1 {Ü}{{\"U}}1
  {â}{{\^a}}1 {ê}{{\^e}}1 {î}{{\^i}}1 {ô}{{\^o}}1 {û}{{\^u}}1
  {Â}{{\^A}}1 {Ê}{{\^E}}1 {Î}{{\^I}}1 {Ô}{{\^O}}1 {Û}{{\^U}}1
  {Ã}{{\~A}}1 {ã}{{\~a}}1 {Õ}{{\~O}}1 {õ}{{\~o}}1
  {œ}{{\oe}}1 {Œ}{{\OE}}1 {æ}{{\ae}}1 {Æ}{{\AE}}1 {ß}{{\ss}}1
  {ű}{{\H{u}}}1 {Ű}{{\H{U}}}1 {ő}{{\H{o}}}1 {Ő}{{\H{O}}}1
  {ç}{{\c c}}1 {Ç}{{\c C}}1 {ø}{{\o}}1 {å}{{\r a}}1 {Å}{{\r A}}1
}

% For easy quotations: \enquote{text}
% This package is very smart when nesting is applied, otherwise textcmds (see below) provides a shorter command
\usepackage[autostyle=true]{csquotes}

% Enable using "`quote"' - see https://tex.stackexchange.com/a/150954/9075
\defineshorthand{"`}{\openautoquote}
\defineshorthand{"'}{\closeautoquote}

% Nicer tables (\toprule, \midrule, \bottomrule)
\usepackage{booktabs}

% Extended enumerate, such as \begin{compactenum}
\usepackage{paralist}

% Bibliopgraphy enhancements
%  - enable \cite[prenote][]{ref}
%  - enable \cite{ref1,ref2}
% Alternative: \usepackage{cite}, which enables \cite{ref1, ref2} only (otherwise: Error message: "White space in argument")

% Doc: http://texdoc.net/natbib
\usepackage[%
  square,        % for square brackets
  comma,         % use commas as separators
  numbers,       % for numerical citations;
  %sort           % orders multiple citations into the sequence in which they appear in the list of references;
  sort&compress  % as sort but in addition multiple numerical citations
                 % are compressed if possible (as 3-6, 15);
]{natbib}

% In the bibliography, references have to be formatted as 1., 2., ... not [1], [2], ...
\renewcommand{\bibnumfmt}[1]{#1.}

% Enable hyperlinked author names in the case of \citet
% Source: https://tex.stackexchange.com/a/76075/9075
\usepackage{etoolbox}
\makeatletter
\patchcmd{\NAT@test}{\else \NAT@nm}{\else \NAT@hyper@{\NAT@nm}}{}{}
\makeatother

% Prepare more space-saving rendering of the bibliography
% Source: https://tex.stackexchange.com/a/280936/9075
\SetExpansion
[ context = sloppy,
  stretch = 30,
  shrink = 60,
  step = 5 ]
{ encoding = {OT1,T1,TS1} }
{ }

% Put figures aside a text
\usepackage[rflt]{floatflt}

% Enable nice comments
\usepackage{pdfcomment}

\newcommand{\commentontext}[2]{\colorbox{yellow!60}{#1}\pdfcomment[color={0.234 0.867 0.211},hoffset=-6pt,voffset=10pt,opacity=0.5]{#2}}
\newcommand{\commentatside}[1]{\pdfcomment[color={0.045 0.278 0.643},icon=Note]{#1}}

% Compatibality with packages todo, easy-todo, todonotes
\newcommand{\todo}[1]{\commentatside{#1}}

% Compatiblity with package fixmetodonotes
\newcommand{\TODO}[1]{\commentatside{#1}}

% Put footnotes below floats
% Source: https://tex.stackexchange.com/a/32993/9075
\usepackage{stfloats}
\fnbelowfloat

\usepackage[group-minimum-digits=4,per-mode=fraction]{siunitx}

% Enable that parameters of \cref{}, \ref{}, \cite{}, ... are linked so that a reader can click on the number an jump to the target in the document
\usepackage{hyperref}

% Enable hyperref without colors and without bookmarks
\hypersetup{
  hidelinks,
  colorlinks=true,
  allcolors=black,
  pdfstartview=Fit,
  breaklinks=true
}

% Enable correct jumping to figures when referencing
\usepackage[all]{hypcap}

\usepackage[caption=false,font=footnotesize]{subfig}

\usepackage{mindflow}

% Extensions for references inside the document (\cref{fig:sample}, ...)
% Enable usage \cref{...} and \Cref{...} instead of \ref: Type of reference included in the link
% That means, "Figure 5" is a full link instead of just "5".
\usepackage[capitalise,nameinlink]{cleveref}

\crefname{section}{Sec.}{Sec.}
\Crefname{section}{Section}{Sections}
\crefname{listing}{List.}{List.}
\crefname{listing}{Listing}{Listings}
\Crefname{listing}{Listing}{Listings}
\crefname{lstlisting}{Listing}{Listings}
\Crefname{lstlisting}{Listing}{Listings}

\usepackage{lipsum}

% For demonstration purposes only
% These packages can be removed when all examples have been deleted
\usepackage[math]{blindtext}
\usepackage{mwe}
\usepackage[realmainfile]{currfile}
\usepackage{tcolorbox}
\tcbuselibrary{listings}

%introduce \powerset - hint by http://matheplanet.com/matheplanet/nuke/html/viewtopic.php?topic=136492&post_id=997377
\DeclareFontFamily{U}{MnSymbolC}{}
\DeclareSymbolFont{MnSyC}{U}{MnSymbolC}{m}{n}
\DeclareFontShape{U}{MnSymbolC}{m}{n}{
  <-6>    MnSymbolC5
  <6-7>   MnSymbolC6
  <7-8>   MnSymbolC7
  <8-9>   MnSymbolC8
  <9-10>  MnSymbolC9
  <10-12> MnSymbolC10
  <12->   MnSymbolC12%
}{}
\DeclareMathSymbol{\powerset}{\mathord}{MnSyC}{180}

\usepackage{xspace}
\newcommand{\eg}{e.g.,\ }
\newcommand{\ie}{i.e.,\ }

% Enable hyphenation at other places as the dash.
% Example: applicaiton\hydash specific
\makeatletter
\newcommand{\hydash}{\penalty\@M-\hskip\z@skip}
% Definition of "= taken from http://mirror.ctan.org/macros/latex/contrib/babel-contrib/german/ngermanb.dtx
\makeatother

% Add manual adapted hyphenation of English words
% See https://ctan.org/pkg/hyphenex and https://tex.stackexchange.com/a/22892/9075 for details
% Does not work on MiKTeX, therefore disabled - issue reported at https://github.com/MiKTeX/miktex-packaging/issues/271
% \input{ushyphex}

% correct bad hyphenation here
\hyphenation{op-tical net-works semi-conduc-tor}

% Add copyright
%
% This is recommended if you intend to send the version to colleagues
% See https://ctan.org/pkg/llncsconf for details
\iffalse
  % state: intended | submitted | llncs
  % you can add "crop" if the paper should be cropped to the format Springer is publishing
  \usepackage[intended]{llncsconf}

  \conference{name of the conference}

  % in case of "proceedings" (final version!)
  % example: \llncs{Anonymous et al. (eds). \emph{Proceedings of the International Conference on \LaTeX-Hacks}, LNCS~42. Some Publisher, 2016.}{0042}
  % 0042 denotes an example start page
  \llncs{book editors and title}{0042}
\fi

% Enable copy and paste of text from the PDF
% Only required for pdflatex. It "just works" in the case of lualatex.
% Alternative: cmap or mmap package
% mmap enables mathematical symbols, but does not work with the newtx font set
% See: https://tex.stackexchange.com/a/64457/9075
% Other solutions outlined at http://goemonx.blogspot.de/2012/01/pdflatex-ligaturen-und-copynpaste.html and http://tex.stackexchange.com/questions/4397/make-ligatures-in-linux-libertine-copyable-and-searchable
% Trouble shooting outlined at https://tex.stackexchange.com/a/100618/9075
%
% According to https://tex.stackexchange.com/q/451235/9075 this is the way to go
\input glyphtounicode
\pdfgentounicode=1

\begin{document}

\title{Gestão de Alojamentos Turísticos}
% If Title is too long, use \titlerunning
%\titlerunning{Short Title}
\subtitle{Programação Orientada a Objetos}

% Single insitute
\author{Enrique George Rodrigues Nº 28602}

% If there are too many authors, use \authorrunning
%\authorrunning{First Author et al.}

\institute{Instituto Politécnico do Cávado e do Ave\\
	Licenciatura Engenharia de Sistemas Informáticos\\
	\vspace{6pt}
	15 de Novembro de 2024}

%% Multiple insitutes - ALTERNATIVE to the above
% \author{%
%     Firstname Lastname\inst{1} \and
%     Firstname Lastname\inst{2}
% }
%
%If there are too many authors, use \authorrunning
%  \authorrunning{First Author et al.}
%
%  \institute{
%      Insitute 1\\
%      \email{...}\and
%      Insitute 2\\
%      \email{...}
%}

\maketitle

\renewcommand{\abstractname}{Resumo.} % Change the abstract title to "Resumo"
\begin{abstract}
	
Este projeto tem como objetivo o desenvolvimento de uma aplicação para a gestão de alojamentos turísticos, permitindo a administração eficiente de registos, reservas e consultas relacionadas com clientes e alojamentos. A solução foi implementada em C\#, utilizando o paradigma de programação orientada a objetos, de forma a garantir uma estrutura modular e escalável. As principais funcionalidades incluem o registo de clientes, a gestão de reservas, o processamento de check-ins e check-outs, bem como o controlo de pagamentos. A aplicação destaca-se pelo uso de dicionários como estruturas de dados eficientes, permitindo um acesso rápido e otimizado a registos de clientes, reservas e alojamentos, com uma complexidade temporal de $O(1)$ para operações de consulta e inserção. A persistência de dados é gerida em formato JSON, proporcionando uma solução leve e prática para operadores turísticos.

\renewcommand{\abstractname}{Resumo}

% Redefine keywords manually since llncs doesn't define \keywordsname
\def\keywords{\vspace{.5em}
	{\textbf{Palavras-chave:}}\,\relax%
}

\keywords{registos, consultas, reservas, check-in, clientes, alojamentos}
\end{abstract}

\newpage
\setcounter{tocdepth}{3}
\renewcommand{\contentsname}{Índice}
\tableofcontents

%\listoffigures

% Ensure figures are numbered sequentially (without chapter number)
\renewcommand{\thefigure}{\arabic{figure}}
% Ensure listings are numbered sequentially (without chapter number)
\renewcommand{\thelstlisting}{\arabic{lstlisting}}
% Re-name listing names
\renewcommand\lstlistingname{Amostra de Código}
\renewcommand\lstlistlistingname{Amostras de Código}
\lstlistoflistings

\newpage
\setcounter{page}{1}
\section{Introdução}
\label{sec:introduction}

\subsection{Contexto e Motivação}
O setor do turismo enfrenta desafios crescentes na gestão eficiente de alojamentos, exigindo soluções que garantam agilidade, precisão e uma experiência satisfatória para os clientes. Este projeto visa desenvolver um sistema de gestão de alojamentos turísticos que permita a administração eficaz de registos de clientes, reservas e alojamentos. A implementação foi realizada em C\#, uma linguagem reconhecida pela sua robustez e flexibilidade, permitindo o desenvolvimento de aplicações escaláveis e eficientes.

\subsection{Estrutura de Dados e Persistência}  
Para garantir um desempenho optimizado, o sistema utiliza dicionários como estruturas de dados principais, baseados em tabelas de hash, que proporcionam um acesso rápido e eficiente às informações cruciais, com uma complexidade temporal de $O(1)$ para operações de consulta e inserção.  

Adicionalmente, a persistência de dados é gerida em formato JSON, o que facilita a integração com outros sistemas e a manipulação dos dados de forma legível e estruturada. No entanto, para operações que exigem maior eficiência em termos de tempo de leitura/escrita, como guardar ou carregar rapidamente os dados sem necessidade de exportação ou importação, utilizamos o \textbf{protobuf-net} para serializar e desserializar os dados em formato binário. Esta abordagem combina a flexibilidade do JSON com a velocidade do formato binário, garantindo um equilíbrio entre interoperabilidade e desempenho.  

\subsection{Boas Práticas de Programação}
Embora a eficiência e a funcionalidade sejam os pilares deste projeto, a aplicação também foi concebida com atenção às boas práticas de programação, promovendo um código limpo e manutenível. Desta forma, o sistema não apenas atende às necessidades atuais do setor, mas também está preparado para futuras evoluções e inovações na gestão de alojamentos turísticos.

\subsection{Objetivos e Organização do Documento}
Este documento descreve o trabalho prático da unidade curricular de Programação Orientada a Objetos, parte integrante da Licenciatura em Engenharia de Sistemas Informáticos no Instituto Politécnico do Cávado e do Ave. O enunciado deste trabalho prático pode ser encontrado no anexo titulado ``Trabalho\_POO\_ESI\_2024\_2025``. O código fonte está disponível no Github e pode ser consultado \href{https://github.com/Basiiii/SmartStay}{aqui}.

\newpage
\section{Padrões e Práticas de Programação}
\label{sec:codingstyle}

Para garantir a consistência, legibilidade e manutenção da base de código, este projeto segue os padrões de programação estabelecidos. Estes padrões estão alinhados com o Guia de Estilo da Microsoft para C\# \cite{microsoftcsharpstyle}, promovendo uniformidade em todo o projeto.

\subsection{Convenções de Nomeação}

A adoção de uma convenção de nomeação clara melhora a clareza do código. As seguintes convenções foram utilizadas ao longo do projeto:

\begin{itemize}
	\item \textbf{Classes e Structs}: \texttt{ClassName}
	\item \textbf{Métodos}: \texttt{MethodName()}
	\item \textbf{Propriedades}: \texttt{PropertyName}
	\item \textbf{Variáveis de Instância e Locais}: \texttt{variableName}
	\item \textbf{Variáveis privadas}: \texttt{\_variableName}
	\item \textbf{Constantes}: \texttt{CONSTANT\_NAME}
	\item \textbf{Parâmetros}: \texttt{parameterName}
	\item \textbf{Enums}: \texttt{EnumName}
\end{itemize}

Evita-se o uso de abreviações excessivas e nomes confusos, promovendo a clareza no código.

\subsection{Regras de Formatação}

A formatação consistente é fundamental para a legibilidade:

\begin{itemize}
	\item \textbf{Indentação}: 4 espaços por nível de indentação, evitando tabs.
	\item \textbf{Comprimento da Linha}: Linhas limitadas a um máximo de 120 caracteres.
	\item \textbf{Chaves}: As chaves de abertura são colocadas na próxima linha da declaração de controle.
	\item \textbf{Espaçamento}: Espaços em branco são usados para separar operadores e ao redor de chaves.
	\item \textbf{Comentários}: Comentários descritivos são utilizados para explicar seções complexas do código, seguindo um estilo consistente.
\end{itemize}

\subsection{Práticas de Programação}

Seguir as melhores práticas garante a qualidade do código:

\begin{itemize}
	\item Utilizam-se nomes claros para variáveis e métodos, tornando o código autoexplicativo.
	\item Escreve-se código claro e conciso, evitando complexidade desnecessária.
	\item Segue-se o Guia de Estilo da Microsoft para C\# \cite{microsoftcsharpstyle} para formatação e estilo gerais, garantindo a conformidade com os padrões da indústria.
\end{itemize}

\subsection{Controlo de Versões}

Utiliza-se Git para o controle de versões, facilitando a gestão eficaz da base de código:

\begin{itemize}
	\item Cria-se uma nova branch para cada funcionalidade ou correção de erro.
	\item As branches são criadas a partir da branch principal para desenvolvimento, com nomes descritivos que refletem a funcionalidade ou erro abordado.
	\item Evita-se fazer commits diretamente na branch principal, garantindo a estabilidade.
	\item As branches de funcionalidade são regularmente fundidas de volta na branch principal após testes completos.
\end{itemize}

\subsection{Documentação}

Utiliza-se \textit{XML Documentation Comments} para documentar o código, permitindo a geração automática de documentação da API:

\begin{itemize}
	\item Segue-se a sintaxe do XML para comentários, documentando métodos, propriedades e classes.
	\item A documentação inclui descrições breves, descrições de parâmetros, descrições de valores de retorno e exemplos de uso.
	\item Utilizam-se tags como \texttt{<summary>}, \texttt{<param>}, \texttt{<returns>} e \texttt{<example>} para estruturar corretamente os comentários.
	\item Define-se o autor nos comentários de cabeçalho de classes para novos ficheiros ou seções significativas de código.
\end{itemize}

\subsection{Padrões de Design Utilizados}

O sistema implementado segue princípios sólidos de engenharia de software, recorrendo a padrões de design bem estabelecidos para garantir uma arquitectura modular, reutilizável e fácil de manter. Dois dos principais padrões utilizados foram:

\begin{itemize}
	\item \textbf{MVC (Model-View-Controller)}: Este padrão foi utilizado para separar as preocupações do sistema. O backend implementa as regras de negócio e a manipulação de dados no modelo (Model), enquanto o frontend é responsável pela apresentação visual (View) e interage com o modelo através de controladores (Controllers). Este design melhora a organização do código e facilita a introdução de alterações numa camada sem impactar as outras.
	
	\item \textbf{Facade (Face)}: Uma classe face do sistema foi utilizada para simplificar e abstrair interações complexas entre diferentes componentes do sistema. Este padrão oferece uma interface simples e clara para funcionalidades comuns.
\end{itemize}

Estes padrões permitiram a divisão eficiente do código em duas camadas principais: backend e frontend, promovendo um design coeso e robusto.

\subsection{Funções Lambda}

O sistema também aproveita as funções lambda para simplificar a manipulação de coleções e propriedades. Estas expressões são frequentemente utilizadas para criar acessores e transformar coleções de forma concisa e eficiente. Seguem dois exemplos ilustrativos:

\vspace*{15pt}
\begin{lstlisting}[ 
	language=csh, 
	caption={Getter e Setter com Função Lambda}, 
	label={lst:lambdaGetterSetter}]
public static int LastAssignedId
{
	get => _lastAccommodationId;
	set => _lastAccommodationId = value;
}
\end{lstlisting}

No exemplo acima, as expressões lambda proporcionam uma forma compacta e clara de definir os métodos de acesso para propriedades.

Outro uso comum de funções lambda é na transformação de colecções:

\vspace*{15pt}
\begin{lstlisting}[ 
	language=csh, 
	caption={Transformação de Colecções com Funções Lambda}, 
	label={lst:lambdaTransformation}]
var accommodationData = new 
{ 
	Id = _id, 
	Type = _type.ToString(), 
	Name = _name, 
	Address = _address,
	Rooms = _rooms.Select(room => new 
	{
		room.Id,
		room.PricePerNight,
		room.Type,
	}) 
};
\end{lstlisting}

Neste caso, as funções lambda são utilizadas em combinação com o método \texttt{Select} para transformar uma lista de quartos, criando um novo objecto para cada elemento com os atributos seleccionados.

Estas utilizações ilustram como as funções lambda podem tornar o código mais legível e expressivo, reduzindo a necessidade de estruturas explícitas de loops.

\newpage
\section{Diagrama de Classes}
\label{sec:classes}

\subsection{Introdução ao Sistema}
O diagrama de classes apresentado descreve a estrutura lógica do sistema de gestão de reservas para alojamentos turísticos, com uma arquitetura desenhada para centralizar e organizar informações essenciais sobre clientes, reservas, alojamentos e pagamentos. Este modelo, por além de otimizar o fluxo de trabalho, promove a extensibilidade e modularidade, facilitando tanto as expansões futuras como a manutenção do sistema.

\subsection{Classes Principais}
No diagrama, cada classe representa uma componente fundamental do sistema. A classe \textit{Client} (cliente) guarda informações sobre um cliente individual, como nome, e-mail e endereço. Para gerir vários clientes, o sistema utiliza a classe \textit{Clients}, que funciona como uma coleção para armazenar e organizar várias instâncias da classe \textit{Client}. Esta coleção é implementada através de um dicionário, permitindo o acesso eficiente e rápido aos dados dos clientes.

A classe \textit{Accommodation} (alojamento) representa as propriedades ou quartos disponíveis para reserva, com informações como o tipo de alojamento, a disponibilidade e o preço por noite. Parecida à classe \textit{Clients}, o sistema utiliza a classe \textit{Accommodations}, que também serve como uma coleção para armazenar e gerir vários alojamentos, sendo implementada através de um dicionário para facilitar a consulta e a manipulação dos dados.

A classe \textit{Reservation} (reserva) liga os clientes aos alojamentos, registando os detalhes da estadia, incluindo as datas de check-in e check-out, o custo total e o estado do pagamento. Tal como as classes \textit{Clients} e \textit{Accommodations}, o sistema utiliza a classe \textit{Reservations}, que guarda uma coleção de reservas, também gerida por um dicionário, permitindo a manipulação eficiente de múltiplas instâncias de reservas.

\subsection{Processamento de Pagamentos}
A classe \textit{Payment} (pagamento) tem como objetivo guardar informações detalhadas sobre cada transação associada a uma reserva, incluindo o montante pago, a data do pagamento e o método utilizado. A classe \textit{Reservation} mantém uma coleção de instâncias da classe \textit{Payment}, permitindo registar todos os pagamentos realizados para uma determinada reserva.

\subsection{BookingManager e a Interface ManageableEntity}
A classe \textit{BookingManager} (gestor de reservas) atua como o controlador principal do sistema, fornecendo métodos para controlar o sistema, gerir alojamentos e processar pagamentos.

O sistema introduz a interface \textit{ManageableEntity}, implementada pelas classes \textit{Clients}, \textit{Reservations} e \textit{Accommodations}. Esta interface unifica os métodos básicos de gestão, como \textit{Add()}, \textit{Remove()}, \textit{Import()} e \textit{Export()}, permitindo que o \textit{BookingManager} interaja com estas classes de forma uniforme. 

\subsection{Padrão de Face (Facade Pattern)}
O \textit{BookingManager} atua como a face do sistema, permitindo simplificar a interação ao consolidar várias chamadas de funções numa única operação. Por exemplo, em vez de chamar funções separadas para criar um objeto \textit{Client} e adicioná-lo ao dicionário de \textit{clients}, a função única \texttt{CreateClient} realiza ambas as operações de forma transparente. Isto segue o \textit{Padrão Facade} \cite{facadepattern}, que fornece uma interface única e centralizada para interagir com o sistema, abstraindo a complexidade interna e promovendo uma maior simplicidade no uso.

Ao centralizar essas operações, o \textit{Facade} melhora a modularidade e extensibilidade do sistema, permitindo que alterações internas sejam realizadas sem impacto na interface externa. Assim, o \textit{BookingManager} fornece um ponto de acesso para a criação, manipulação e gestão das entidades, facilitando a manutenção e escalabilidade do sistema.

\begin{figure}[h!]
	\centering
	\includegraphics[width=1.0\textwidth]{Images/POO_Class_Diagram.png}
	\caption{Diagrama de Classes do Sistema de Gestão de Alojamentos Turísticos}
	\label{fig:diagrama_classes}
\end{figure}

\newpage
\section{Organização do Código}
\label{sec:organizacaocodigo}

A arquitetura do sistema foi estruturada de acordo com um layout comum e amplamente utilizado em aplicações de software, que segue o padrão de separação de responsabilidades entre diferentes camadas. Este padrão facilita a manutenção, escalabilidade e testabilidade do sistema. A divisão em \textit{Models}, \textit{Repositories}, \textit{Services} e \textit{Utilities} organiza a aplicação de maneira modular e coesa, garantindo que cada componente tenha uma função clara e bem definida. Cada classe é guardada num ficheiro chamado de forma correspondente, reforçando a organização e facilitando a navegação no código.

\subsection{Nomeação de Ficheiros}
Para manter uma estrutura organizada e intuitiva, os ficheiros do sistema foram nomeados de acordo com as classes que eles contêm. Cada classe tem um ficheiro correspondente com o mesmo nome, garantindo uma correspondência direta entre a funcionalidade e o ficheiro onde ela está implementada. Esta abordagem facilita a localização de classes específicas e melhora a navegabilidade do projeto, uma vez que o nome de cada ficheiro reflete o conteúdo e a responsabilidade do mesmo. Por exemplo, a classe \textit{Client} está localizada no ficheiro \texttt{Client.cs}, enquanto a classe \textit{BookingManager} pode ser encontrada em \texttt{BookingManager.cs}.

\subsection{Conformidade com a CLS}

A \textit{Common Language Specification (CLS)} define um conjunto de regras e padrões para garantir a interoperabilidade entre as diferentes linguagens que compõem o ecossistema .NET. Ao desenvolver o sistema, foi dada atenção à conformidade com a CLS para assegurar que o código seja acessível e utilizável por outras linguagens compatíveis com o .NET.

Dentro deste contexto, o tipo \texttt{decimal} foi escolhido para operações financeiras e monetárias devido à sua alta precisão e, também, por ser um tipo que segue as normas da CLS. Esta conformidade permite que o sistema mantenha uma representação exata de valores monetários e seja facilmente reutilizável em outros ambientes e linguagens que suportem .NET. 

Cabe destacar que nem todos os tipos numéricos são compatíveis com a CLS — por exemplo, tipos inteiros não-assinados (\textit{unsigned}) como \texttt{uint} e \texttt{ulong} não são CLS-compliant e podem apresentar problemas de interoperabilidade em algumas linguagens. A escolha de tipos compatíveis com a CLS reforça o compromisso com a robustez e a acessibilidade do sistema em um ambiente .NET multi-linguagem.

\subsection{Models} A camada de \textit{Models} é responsável por representar os dados essenciais do sistema. Nesta camada, as classes de modelo (como \textit{Client}, \textit{Accommodation} e \textit{Reservation}) são definidas com propriedades e comportamentos relacionados aos dados que representam. Esses modelos são frequentemente utilizados para mapear as entidades que serão manipuladas pela aplicação, sendo a base para as operações de armazenamento e recuperação de dados. Além disso, os modelos podem incluir validações de dados e regras de negócio específicas, facilitando a comunicação entre as diferentes camadas.

\subsection{Repositories} A camada de \textit{Repositories} no nosso sistema é responsável por guardar e organizar listas de objetos de diferentes tipos, como Clientes, Alojamentos e Reservas. Esta camada serve como um \textit{container} centralizado para gerir estes conjuntos de dados durante a execução do programa, proporcionando um acesso estruturado e consistente às informações.

\subsection{Services} A camada de \textit{Services} contém a lógica de negócio principal da aplicação. Os serviços orquestram as interações entre os modelos e os repositórios, executando operações mais complexas que envolvem várias entidades ou ações. No contexto do nosso sistema de gestão de reservas, o \textit{BookingManager} pode ser considerado um serviço, pois gere o processo de reservas, incluindo a criação, validação e processamento de pagamentos.

\subsection{Utilities} A camada de \textit{Utilities} contém classes e métodos auxiliares que oferecem funcionalidades que podem ser usadas em diferentes partes do sistema. Exemplos típicos incluem ferramentas de validação, manipulação de strings, loggers e geradores de relatórios. As \textit{Utilities} ajudam a manter o código limpo e reutilizável, evitando a duplicação de lógica em várias partes da aplicação. Por exemplo, um validador de datas ou um utilitário de formatação de preços pode ser usado em diferentes componentes, como na criação de reservas e no processamento de pagamentos.

\subsection{Bibliotecas}  
A organização do código também foi complementada com a utilização de bibliotecas específicas, armazenadas na pasta \texttt{Libraries}, para promover a separação de responsabilidades e a modularidade do sistema. Estas bibliotecas foram estruturadas para encapsular diferentes funcionalidades do sistema, permitindo uma gestão mais clara e eficiente das preocupações. Abaixo descrevemos as principais bibliotecas criadas:  

\begin{itemize}  
	\item \textbf{SmartStay.Common}: Esta biblioteca foi criada para conter elementos comuns que são utilizados por todas as partes do sistema. Ela inclui definições de \textit{enums}, constantes e outros componentes genéricos que podem ser reutilizados de maneira transversal. Ao centralizar esses elementos na biblioteca \texttt{SmartStay.Common}, é possível reduzir a redundância de código e melhorar a consistência em diferentes partes da aplicação.  
	
	\item \textbf{SmartStay.Core}: A biblioteca central do sistema, \texttt{SmartStay.Core}, agrupa os modelos, repositórios, serviços e utilitários. Esta biblioteca encapsula a lógica de negócio principal e os elementos estruturais do sistema, assegurando uma clara separação entre os dados e as operações que os manipulam. Por exemplo, todas as classes de modelo, como \texttt{Client} e \texttt{Reservation}, bem como os repositórios que armazenam listas de objetos, estão organizados nesta biblioteca.
	
	\item \textbf{SmartStay.IO}: A biblioteca \texttt{SmartStay.IO} é responsável por lidar com operações de entrada e saída, particularmente o gerenciamento de dados em formato \textit{JSON}. Ela encapsula toda a lógica relacionada à leitura e escrita de informações, permitindo que o sistema realize a persistência de dados de maneira modular. Esta abordagem melhora a manutenção, pois mudanças na forma como os dados são armazenados ou carregados podem ser feitas exclusivamente nesta biblioteca, sem impactar outras partes do sistema.  
	
	\item \textbf{SmartStay.Validation}: A biblioteca \texttt{SmartStay.Validation} foi projetada para centralizar toda a lógica de validação de dados do sistema. Ela inclui regras específicas para garantir a integridade dos dados inseridos e manipulados pelo sistema, como validações de datas e formatos de entrada. Este design promove a reutilização de lógica de validação em diferentes componentes, aumentando a consistência e facilitando futuras alterações ou expansões nas regras de validação.
\end{itemize}  

A utilização destas bibliotecas reflete um compromisso com a separação de preocupações (\textit{Separation of Concerns}), promovendo uma arquitetura limpa, extensível e de fácil manutenção. Cada biblioteca tem um propósito bem definido e pode ser atualizada ou substituída de forma independente, reduzindo a complexidade e os riscos associados a alterações no sistema.  

\newpage
\section{Estruturas de Dados Utilizadas}
\label{sec:estruturasdados}

\subsection{Utilização de Dictionary}
As estruturas de dados escolhidas para o sistema foram definidas com o objetivo de otimizar a eficiência e o desempenho, especialmente em operações de busca, inserção e remoção. A principal estrutura de dados utilizada foi o \textit{Dictionary} (dicionário), que oferece uma maneira eficiente de armazenar e aceder a entidades como clientes, reservas e alojamentos, por meio de chaves únicas. Esta estrutura garante um tempo de acesso quase constante para operações como inserção e busca, o que é essencial para o bom desempenho do sistema, especialmente à medida que o número de entidades cresce.

\vspace*{15pt}
\begin{lstlisting}[ 
	language=csh, 
	caption={Uso de Dictionary}, 
	label={lst:C}]
readonly Dictionary<int, Client> _clientDictionary = new Dictionary<int, Client>();
\end{lstlisting}

O uso do \textit{Dictionary} garante que as operações de inserção e remoção de clientes sejam realizadas de forma rápida, com um tempo médio de execução constante $O(1)$, o que melhora a escalabilidade do sistema à medida que mais clientes são adicionados.

\subsection{Utilização de SortedSet}

Para a classe \textit{Room}, foi utilizada a estrutura \textit{SortedSet<DateRange>} para guardar os intervalos de datas das reservas. O \textit{SortedSet} é uma coleção que mantém os elementos em ordem, o que permite realizar buscas e verificações de maneira eficiente. A principal vantagem do \textit{SortedSet} sobre outras estruturas, como listas ou dicionários, é que ele mantém a ordem dos elementos automaticamente e proporciona operações eficientes de inserção, remoção e busca.

O \textit{SortedSet} é baseado numa árvore binária balanceada, tipicamente uma árvore vermelho-preta (\textit{Red-Black Tree}), que garante um tempo de execução logarítmico para as operações básicas: inserção, remoção e busca, ou seja, $O(log n)$. Isto acontece porque, ao usar uma árvore binária balanceada, o \textit{SortedSet} mantém o conjunto de dados ordenados, sem a necessidade de reordenar os elementos manualmente a cada operação.

Abaixo está um exemplo de como o sistema verifica a disponibilidade de um alojamento utilizando o \textit{SortedSet<DateRange>}:

\vspace*{15pt}
\begin{lstlisting}[ 
	language=csh, 
	caption={Uso de Dictionary}, 
	label={lst:C}]
public bool IsAvailable(DateTime startDate, DateTime endDate, DateRange? existingReservationRange = null)
{
	if (endDate <= startDate)
	throw new ArgumentException("End date must be after the start date.");
	
	var newReservation = new DateRange(startDate, endDate);
	
	// Get potential conflicting reservations within the requested range
	var potentialConflicts = _reservationDates.GetViewBetween(
	new DateRange(DateTime.MinValue, startDate), // All reservations that end before the start
	new DateRange(DateTime.MaxValue, endDate)    // All reservations that start after the end
	);
	
	// Check if there are any overlapping reservations
	foreach (var existingReservation in potentialConflicts)
	{
		// Skip the existing reservation if it's the one we're trying to modify
		if (existingReservation.Equals(existingReservationRange))
		{
			continue; // Skip this reservation as it's the one we're modifying
		}
		
		// An overlap occurs if the start date is before the end date, and the end date is after the start date
		if ((newReservation.Start < existingReservation.End) && (newReservation.End > existingReservation.Start))
		{
			return false; // There's an overlap, so the accommodation is not available
		}
	}
	
	return true; // No overlap found, accommodation is available
}
\end{lstlisting}

O uso do \textit{SortedSet} permite que o sistema verifique rapidamente se há conflitos de datas para uma nova reserva. Quando uma nova reserva é solicitada, o método \texttt{GetViewBetween} é utilizado para obter apenas as reservas que podem potencialmente se sobrepor com a nova reserva, o que torna o processo de verificação muito mais eficiente.

A principal vantagem do \textit{SortedSet} é que ele mantém os dados ordenados automaticamente, e as operações de busca e inserção são realizadas em tempo $O(log n)$, o que é muito mais eficiente do que um algoritmo de busca linear que teria um custo de $O(n)$. Em sistemas com muitas reservas, isto resulta num ganho de desempenho significativo.

Além disso, a estrutura \textit{SortedSet} oferece uma forma eficiente de lidar com a inserção de novos intervalos de datas, pois a árvore binária balanceada garante que as operações de inserção e remoção também sejam realizadas de maneira logarítmica. Isso é fundamental para garantir que o sistema permaneça escalável à medida que o número de reservas aumenta.

\subsection{Vantagens das Estruturas de Dados Escolhidas}

As escolhas do \textit{Dictionary} e \textit{SortedSet} refletem uma análise cuidadosa das necessidades do sistema, como a eficiência de acesso, a escalabilidade e a organização dos dados. Abaixo, destacam-se as principais vantagens dessas escolhas:

\begin{itemize}
	\item \textbf{Eficiência de Acesso}: O \textit{Dictionary} permite acesso rápido às entidades, como clientes e reservas, através de chaves únicas. Esta característica é fundamental para garantir o bom desempenho do sistema, especialmente quando precisa de lidar com grandes volumes de dados.
	\item \textbf{Escalabilidade}: O uso do \textit{Dictionary} para guardar entidades e do \textit{SortedSet} para as datas das reservas garante um sistema escalável. À medida que o número de clientes ou reservas aumenta, o desempenho mantém-se estável devido à eficiência destas estruturas.
	\item \textbf{Verificação Rápida de Conflitos de Datas}: O \textit{SortedSet} facilita a verificação de conflitos de datas de reservas, graças à sua capacidade de manter os dados ordenados automaticamente. A combinação com a operação \texttt{GetViewBetween} reduz significativamente o tempo de busca e garante uma execução eficiente mesmo com um número elevado de reservas.
\end{itemize}

Estas escolhas refletem uma análise cuidadosa dos requisitos de desempenho e eficiência do sistema, buscando sempre o equilíbrio entre a simplicidade na implementação o alto desempenho. Isto garante um sistema não apenas eficaz, mas também fácil de manter e escalar ao longo do tempo.

\newpage
\section{Uso de LINQ}
\label{sec:usodelinq}

No desenvolvimento do sistema, foi utilizado o LINQ (\textit{Language Integrated Query}) para facilitar a consulta e manipulação de coleções de dados, proporcionando uma forma mais concisa e legível de trabalhar com dados em memória. O LINQ integra-se diretamente no código C\#, permitindo escrever consultas diretamente nas coleções, sem necessidade de recorrer a linguagens de consulta externas ou a loops complicados.

\subsection{Vantagens de LINQ}

O LINQ oferece várias vantagens, entre as quais se destacam:

\begin{itemize}
	\item \textbf{Sintaxe Concisa e Legível}: Permite escrever consultas de forma mais direta e legível, o que resulta em um código mais limpo e fácil de entender.
	\item \textbf{Integração com Coleções de Dados}: Pode ser utilizado diretamente sobre coleções de objetos como listas, arrays, e dicionários, o que facilita a manipulação de dados sem recorrer a ferramentas externas.
	\item \textbf{Redução de Erros e Complexidade}: Ao abstrair a complexidade da consulta e manipulação de dados, o LINQ reduz as possibilidades de erros e torna o código mais modular e menos propenso a falhas.
	\item \textbf{Execução Diferida}: O LINQ utiliza execução diferida, ou seja, a consulta só é executada quando necessário, o que pode melhorar o desempenho, especialmente quando se lida com um volume grande de dados.
\end{itemize}

\subsection{Utilização de LINQ no Código}

A seguir, são apresentados exemplos de como o LINQ foi utilizado no código para realizar operações de filtragem em coleções de dados.

O primeiro exemplo mostra como o LINQ é usado para encontrar todas as reservas associadas a um cliente, dado o seu ID único. A função `\textit{FindReservationsByClientId()}` filtra o dicionário de reservas, retornando apenas as reservas que correspondem ao `\textit{clientId}` fornecido.


\vspace*{15pt}
\renewcommand{\lstlistingname}{Amostra de Código}
\begin{lstlisting}[ 
	language=csh, 
	caption={Encontra Reservas por ID de Cliente}, 
	label={lst:C}],
public IEnumerable<Reservation> FindReservationsByClientId(int clientId)
{
	return _reservationDictionary.Values.Where(r => r.ClientId == clientId);
}
\end{lstlisting}

No segundo exemplo, o LINQ é utilizado para encontrar todas as reservas associadas a um alojamento específico, filtrando as reservas pelo `AccommodationId`. A função `FindReservationsByAccommodationId` realiza uma consulta parecida, mas com base no ID do alojamento.

\begin{lstlisting}[ 
	language=csh, 
	caption={Encontra Reservas por ID de Alojamento}, 
	label={lst:C}]
public IEnumerable<Reservation> FindReservationsByAccommodationId(int accommodationId)
{
	return _reservationDictionary.Values.Where(r => r.AccommodationId == accommodationId);
}
\end{lstlisting}

Estes exemplos demonstram como o LINQ simplifica a filtragem de dados nas coleções, tornando o código mais legível e eficiente.

\newpage
\section{Tratamento de Exceções}
\label{sec:tratamentoexcecoes}

A escolha de utilizar códigos de erro, ao invés de mensagens \textit{hardcoded}, proporciona maior flexibilidade, reutilização e facilita a manutenção do código. Além disso, permite uma melhor adaptação a mudanças nas regras de negócio, sem a necessidade de alteração direta nas mensagens de erro.

\subsection{Estrutura das Exceções}
A base para o tratamento de exceções no sistema é a classe \texttt{ValidationException}. Esta classe personalizada herda da classe base \texttt{Exception} e é usada para encapsular falhas de validação que ocorrem durante o processamento dos dados.

A principal característica da \texttt{ValidationException} é que ela recebe um código de erro (do tipo \texttt{ValidationErrorCode}) e, ao ser instanciada, busca automaticamente a mensagem correspondente através da classe \texttt{ValidationErrorMessages}. O código abaixo apresenta a implementação básica desta exceção personalizada:

\begin{lstlisting}[
	language=csh, 
	caption={Classe ValidationException}, 
	label={lst:C}]
public class ValidationException : Exception
{
	public ValidationErrorCode ErrorCode { get; }
	
	public ValidationException(ValidationErrorCode errorCode) : base(ValidationErrorMessages.GetErrorMessage(errorCode))
	{
		ErrorCode = errorCode;
	}
}
\end{lstlisting}

Como pode ser visto, ao receber um \texttt{ValidationErrorCode}, a classe \texttt{ValidationException} utiliza o método \texttt{GetErrorMessage} da classe \texttt{ValidationErrorMessages} para obter a mensagem correspondente ao erro, evitando a necessidade de codificar as mensagens diretamente na aplicação.

\subsection{Definição dos Códigos de Erro}
A enumeração \texttt{ValidationErrorCode} é responsável por definir os diferentes tipos de erros que podem ocorrer durante a validação dos dados. Cada valor desta enumeração é associado a um código numérico único, o que permite identificar de forma eficiente qual validação falhou.

Abaixo está um exemplo simplificado desta enumeração:

\begin{lstlisting}[
	language=csh, 
	caption={Enumeração ValidationErrorCode}, 
	label={lst:C}]
namespace SmartStay.Validation
{
	public enum ValidationErrorCode
	{
		InvalidName = 1001,
		InvalidEmail = 1002,
		InvalidPhoneNumber = 1003
	}
}
\end{lstlisting}

\subsection{Mensagens de Erro Dinâmicas}
A classe \texttt{ValidationErrorMessages} é responsável por buscar as mensagens de erro localizadas a partir de ficheiros de recursos. Em vez de guardar as mensagens diretamente no código, as mensagens são mantidas em ficheiros de recursos (.resx), o que facilita a tradução e manutenção das mensagens de erro, especialmente em sistemas com muitos idiomas.

Veja abaixo um exemplo simplificado da classe \textit{ValidationErrorMessages}:

\begin{lstlisting}[
	language=csh, 
	caption={Classe ValidationErrorMessages}, 
	label={lst:C}]
public static class ValidationErrorMessages
{
	private static readonly ResourceManager _resourceManager = new ResourceManager(
	"SmartStay.Validation.Resources.ValidationMessages", typeof(ValidationErrorMessages).Assembly);
	
	public static string GetErrorMessage(ValidationErrorCode errorCode)
	{
		return _resourceManager.GetString(errorCode.ToString(), CultureInfo.CurrentCulture) ??
		"Unknown validation error.";
	}
}
\end{lstlisting}

Desta forma, quando uma exceção de validação é gerada, a mensagem correspondente ao código de erro é obtida dinamicamente a partir do ficheiro de recursos com base na cultura atual. Caso o código de erro não esteja mapeado, uma mensagem padrão "Unknown validation error." \textit{("Erro de validação desconhecido")} será devolvida, garantindo que todas as exceções são tratadas de forma consistente e traduzidas corretamente para o idioma apropriado.

\subsection{Benefícios da Abordagem}
A utilização de códigos de erro e mensagens dinâmicas traz uma série de benefícios para o sistema:

\begin{itemize}
	\item \textbf{Facilidade de Manutenção}: A manutenção das mensagens de erro torna-se mais simples, uma vez que as mensagens estão centralizadas num único local e não espalhadas pelo código.
	\item \textbf{Escalabilidade}: Novos erros podem ser facilmente adicionados à enumeração e ao dicionário de mensagens, sem a necessidade de reescrever as exceções ou a lógica de validação.
	\item \textbf{Internacionalização}: Como as mensagens de erro estão centralizadas, é mais fácil adaptar o sistema para diferentes idiomas no futuro.
	\item \textbf{Consistência}: Ao utilizar códigos de erro numéricos e associar cada um a uma mensagem específica, garantimos que o tratamento de exceções será consistente ao longo de toda a aplicação.
\end{itemize}

\newpage
\section{Tratamento de Logs}
\label{sec:tratamentologs}

\subsection{Objetivo de Logs}

\subsection{Exemplos de Logging no Código}

\newpage
\section{Persistência de Dados com Ficheiros}
\label{sec:persistenciadados}

A persistência de dados é uma componente essencial para qualquer sistema de gestão. No caso deste projeto, optou-se por utilizar ficheiros JSON para importar e exportar os dados, enquanto a persistência binária é feita utilizando \texttt{Protocol Buffers} (Protobuf). O formato JSON foi escolhido para a importação e exportação devido à sua popularidade e facilidade de uso, especialmente em aplicações web, móveis e desktop. Além disso, JSON é altamente legível, permitindo que os dados sejam facilmente manipulados e depurados.

Para a persistência binária, foi escolhido o \texttt{Protobuf}, em vez dos métodos tradicionais binários como o \texttt{BinaryFormatter}, que é obsoleto e apresenta vulnerabilidades de segurança. O \texttt{BinaryFormatter} tem riscos significativos na desserialização de dados, o que pode resultar em falhas de segurança, como execução remota de código. O \texttt{Protobuf}, por outro lado, oferece uma solução mais segura, eficiente e compacta para armazenar dados de forma binária. Além disso, é compatível com diversas linguagens e plataformas, o que facilita a integração com outros sistemas.

Portanto, enquanto o JSON é utilizado para a leitura e manipulação de dados de forma mais acessível, o \texttt{Protobuf} é usado para a gravação e carregamento eficiente de dados binários, garantindo melhor desempenho e menor tamanho de ficheiro. Este equilíbrio entre formatos textuais e binários permite que o sistema aproveite o melhor de ambos os mundos: a simplicidade e flexibilidade do JSON para operações de importação/exportação e a eficiência do \texttt{Protobuf} para persistência binária.

\subsection{Importação e Exportação de Dados}

Para garantir que os dados possam ser facilmente armazenados e recuperados de forma persistente, foram implementados métodos para exportar e importar os dados para e a partir de JSON, enquanto a persistência binária é feita utilizando \texttt{Protocol Buffers} (Protobuf). O Protobuf foi escolhido como alternativa ao tradicional formato binário, pois oferece vantagens em termos de eficiência e compactação de dados, além de ser mais moderno e amplamente suportado. 

A seguir, são apresentados os métodos utilizados para a importação e exportação de dados no formato JSON, que é utilizado para facilitar a leitura e manipulação dos dados em formato textual. Já a persistência binária, voltada para a gravação e leitura de dados de forma mais eficiente e compacta, é realizada utilizando Protobuf. O uso do Protobuf, em vez dos formatos binários tradicionais, é uma escolha estratégica para garantir melhor desempenho, menor tamanho de arquivo e maior compatibilidade entre diferentes plataformas.

A abordagem de importação e exportação é aplicada de maneira similar tanto para a lista de clientes, quanto para acomodações e reservas.

\subsubsection{Importação de Dados}

O método \texttt{Import} permite importar uma lista de objetos a partir de uma string JSON. Caso a string JSON seja inválida ou nula, são lançadas exceções específicas para garantir que os dados sejam válidos antes de serem inseridos na coleção. O código seguinte apresenta um exemplo do método \textit{Import} dos clientes:

\begin{lstlisting}[
	language=csh, 
	caption={Método Import para Importar Clientes}, 
	label={lst:C}]
public ImportResult Import(string data)
{
	if (string.IsNullOrEmpty(data))
	{
		throw new ArgumentException("Data cannot be null or empty", nameof(data));
	}
	
	// Deserialize the data into a List<Client> instead of a single Client
	var clients = JsonHelper.DeserializeFromJson<Client>(data) ??
	throw new ArgumentException("Deserialized client data cannot be null", nameof(data));
	
	int replacedCount = 0;
	int importedCount = 0;
	
	foreach (var client in clients)
	{
		if (_clientDictionary.ContainsKey(client.Id))
		{
			replacedCount++;
		}
		else
		{
			importedCount++;
		}
		_clientDictionary[client.Id] = client; // Direct insertion for efficiency
	}
	
	return new ImportResult { ImportedCount = importedCount, ReplacedCount = replacedCount };
}
\end{lstlisting}

No método \texttt{Import}, são realizadas as seguintes validações:
\begin{itemize}
	\item Se a string \texttt{data} for nula ou vazia, uma exceção \texttt{ArgumentException} é lançada.
	\item A deserialização do JSON é realizada utilizando um método auxiliar (\texttt{DeserializeFromJson}), e, caso falhe, outra exceção \texttt{ArgumentException} é gerada.
	\item Para cada cliente na lista importada, o cliente é adicionado ao dicionário \texttt{\_clientDictionary}, substituindo qualquer cliente existente com o mesmo ID.
	\item O método \texttt{Import} retorna um objeto \texttt{ImportResult}, que contém a quantidade de clientes importados e substituídos, proporcionando informações úteis sobre o processo de importação.
\end{itemize}

\subsubsection{Exemplo de Exportação de Dados}

O método \texttt{Export} permite exportar a lista atual de clientes para uma string JSON, que pode ser armazenada num ficheiro ou enviada para outros sistemas. O código do método é o seguinte:

\begin{lstlisting}[
	language=csh, 
	caption={Método Export para Exportar Clientes},
	label={lst:C}]
public string Export()
{
	return JsonHelper.SerializeToJson(_clientDictionary.Values ?? Enumerable.Empty<Client>());
}
\end{lstlisting}

O método \texttt{Export} converte os valores armazenados no dicionário \texttt{\_clientDictionary} numa string JSON utilizando o método auxiliar \texttt{SerializeToJson}. Se o dicionário estiver vazio, é retornada uma coleção vazia para garantir que o formato JSON seja válido.

Neste método, os valores do dicionário \texttt{\_clientDictionary} são serializados diretamente para uma string JSON. O uso de \texttt{Enumerable.Empty<Client>()} garante que, caso não existam clientes no dicionário, uma lista vazia seja serializada, evitando problemas com a estrutura JSON.

\subsection{Validação e Exceções na Persistência de Dados}

É importante garantir que os dados sejam consistentes e válidos antes de serem persistidos no formato JSON. Para isso, o sistema inclui verificações e exceções que asseguram que a importação e exportação dos dados sejam feitas corretamente.

As exceções tratadas nas operações de importação e exportação incluem:
\begin{itemize}
	\item \textbf{ArgumentException}: Lançada quando os dados fornecidos são nulos, vazios ou falham na desserialização.
	\item \textbf{InvalidOperationException}: Pode ser lançada em casos em que ocorre uma operação inesperada, como ao tentar aceder dados que não foram carregados corretamente.
\end{itemize}

Estas exceções permitem que o sistema lide com dados inválidos de forma controlada, sem causar falhas inesperadas. Além disso, a validação dos dados durante a importação e exportação impede que dados corrompidos ou malformados sejam persistidos, garantindo a integridade do sistema.

\subsection{Considerações Finais sobre a Persistência de Dados}

A escolha pelo formato JSON para persistência de dados oferece diversas vantagens em termos de simplicidade, flexibilidade e compatibilidade. A utilização de métodos de importação e exportação bem definidos, aliados ao tratamento de exceções para garantir a validade dos dados, proporciona um sistema robusto e fácil de manter. Além disso, a escolha de um formato de dados leve e amplamente suportado como o JSON garante que o sistema possa ser facilmente integrado a outras plataformas e serviços.

\subsection{Persistência de Dados com Protobuf}

Embora o formato JSON seja simples e eficaz, em alguns cenários, como sistemas com grandes volumes de dados ou requisitos de desempenho mais exigentes, pode ser vantajoso utilizar um formato binário mais compacto e eficiente. Nesse contexto, o \texttt{Protocol Buffers} (Protobuf) se apresenta como uma alternativa poderosa.

Protobuf é um formato binário de serialização de dados desenvolvido pelo Google, que permite uma codificação e decodificação mais rápida e compacta do que o JSON. Ao contrário do JSON, que é um formato de texto, o Protobuf armazena os dados de forma binária, o que reduz o tamanho do arquivo e melhora o desempenho em operações de leitura e escrita, especialmente quando lidamos com grandes volumes de dados.

\subsubsection{Vantagens do Protobuf}

O uso do Protobuf para persistência de dados oferece várias vantagens:
\begin{itemize}
	\item \textbf{Eficiência de Espaço}: Como o Protobuf é um formato binário, ele é muito mais compacto em comparação ao JSON, o que resulta em menos uso de espaço de armazenamento.
	\item \textbf{Desempenho Superior}: O Protobuf oferece tempos de leitura e escrita mais rápidos devido à sua natureza binária, tornando-o adequado para sistemas com alto tráfego de dados.
	\item \textbf{Compatibilidade entre Linguagens}: O Protobuf é suportado por uma ampla gama de linguagens de programação, facilitando a integração entre sistemas escritos em diferentes linguagens.
	\item \textbf{Versatilidade}: O Protobuf oferece suporte para esquemas evolutivos, permitindo adicionar novos campos aos dados sem quebrar a compatibilidade com versões anteriores.
\end{itemize}

\subsubsection{Importação e Exportação de Dados com Protobuf}

Para integrar o Protobuf à persistência de dados, os dados são convertidos para o formato binário utilizando os métodos de serialização e desserialização do Protobuf. O código a seguir mostra como importar e exportar dados de clientes usando Protobuf.

\paragraph{Importação de Dados com Protobuf}

O método \texttt{ImportProtobuf} permite importar uma lista de clientes a partir de um arquivo binário Protobuf. Caso o arquivo seja inválido ou os dados não possam ser desserializados, são lançadas exceções específicas.

\begin{lstlisting}[
	language=csh, 
	caption={Método Import para Importar Clientes com Protobuf}, 
	label={lst:protobuf-import}]
public void ImportProtobuf(string filePath)
{
	if (string.IsNullOrEmpty(filePath))
	{
		throw new ArgumentException("File path cannot be null or empty", nameof(filePath));
	}
	
	byte[] data = File.ReadAllBytes(filePath);
	
	try
	{
		var clients = ProtobufHelper.DeserializeFromProtobuf<List<Client>>(data);
		foreach (var client in clients)
		{
			_clientDictionary[client.Id] = client;
		}
	}
	catch (Exception ex)
	{
		throw new InvalidOperationException("Failed to deserialize Protobuf data", ex);
	}
}
\end{lstlisting}

O método \texttt{ImportProtobuf} realiza as seguintes operações:
\begin{itemize}
	\item Verifica se o caminho do arquivo fornecido é válido.
	\item Lê os bytes do arquivo binário e tenta desserializar os dados usando o método auxiliar \texttt{DeserializeFromProtobuf}.
	\item Para cada cliente deserializado, o cliente é adicionado ao dicionário \texttt{\_clientDictionary}.
\end{itemize}

\paragraph{Exportação de Dados com Protobuf}

O método \texttt{ExportProtobuf} permite exportar a lista de clientes para um arquivo binário Protobuf. O código a seguir mostra como implementar essa funcionalidade.

\begin{lstlisting}[
	language=csh, 
	caption={Método Export para Exportar Clientes com Protobuf},
	label={lst:C}]
	public void ExportProtobuf(string filePath)
	{
		var clients = _clientDictionary.Values.ToList();
		byte[] data = ProtobufHelper.SerializeToProtobuf(clients);
		
		File.WriteAllBytes(filePath, data);
	}
\end{lstlisting}

O método \texttt{ExportProtobuf} realiza as seguintes operações:
\begin{itemize}
	\item Converte a lista de clientes do dicionário \texttt{\_clientDictionary} em um formato adequado para serialização.
	\item Serializa os dados usando o método auxiliar \texttt{SerializeToProtobuf}.
	\item Escreve os dados serializados no arquivo especificado.
\end{itemize}

\subsubsection{Tratamento de Exceções na Persistência com Protobuf}

Assim como no caso do JSON, é importante tratar as exceções adequadas durante a importação e exportação de dados com Protobuf. As exceções mais comuns são:
\begin{itemize}
	\item \textbf{ArgumentException}: Lançada quando o caminho do arquivo fornecido é nulo ou vazio.
	\item \textbf{InvalidOperationException}: Lançada quando ocorre um erro ao tentar ler ou escrever os dados no formato Protobuf, como falha na desserialização ou serialização.
	\item \textbf{FileNotFoundException}: Lançada quando o arquivo especificado não é encontrado durante a leitura.
\end{itemize}

Essas exceções garantem que qualquer erro no processo de leitura ou escrita dos dados seja tratado de forma controlada.

\subsection{Considerações Finais sobre o Uso do Protobuf}

O uso do Protobuf para persistência de dados pode ser uma excelente escolha em cenários que exigem maior eficiência de desempenho e menor uso de espaço. Embora o formato binário possa ser mais difícil de depurar em comparação ao JSON, ele oferece vantagens consideráveis em termos de desempenho e escalabilidade, tornando-o ideal para aplicações de grande escala ou sistemas distribuídos. A integração do Protobuf à persistência de dados, juntamente com a validação e tratamento de exceções, permite criar um sistema robusto, eficiente e escalável.

\newpage
\section{Testes Unitários}
\label{sec:testesunitarios}

\subsection{CI/CD Pipeline}


\newpage
\section{Arquitetura em Camadas (Layered Architecture)}
\label{sec:arquiteturacamadas}

A adoção de uma arquitetura em camadas é uma prática muito reconhecida para organizar e estruturar o código de uma aplicação, visando separar responsabilidades e promover escalabilidade e manutenção. Dentro desta abordagem, o padrão de \textbf{Model-View-Controller (MVC)} \cite{mvc} foi escolhido para gerir a interface de utilizador e a lógica de aplicação. Este padrão permite uma divisão clara entre as camadas que lidam com os dados, a lógica de negócio e a apresentação visual, facilitando o desenvolvimento modular e a evolução do sistema ao longo do tempo.

\subsection{Escolha da Arquitetura}

O padrão \textbf{MVC (Model-View-Controller)} \cite{mvc} foi escolhido pela sua capacidade de simplificar o desenvolvimento de interfaces de utilizador complexas ao isolar as responsabilidades de cada componente. No contexto de um sistema de gestão de alojamentos, onde há interações contínuas entre utilizadores, dados e regras de negócio, o MVC destaca-se pela facilidade com que permite adicionar ou modificar funcionalidades na interface sem impactar diretamente a lógica de negócio ou a camada de dados.

As vantagens do MVC incluem:

\begin{itemize}
	\item \textbf{Modularidade e Reutilização}: A estrutura do MVC facilita a reutilização de código, pois a lógica de negócio (Controller) e os dados (Model) são isolados da camada de apresentação (View), permitindo que o sistema suporte múltiplas interfaces ou plataformas sem duplicação de lógica.
	\item \textbf{Facilidade de Testes e Manutenção}: A divisão de responsabilidades permite testes mais eficazes em cada camada, especialmente na camada de lógica (Controller), que pode ser isolada para testes unitários sem necessidade de interações com a interface.
	\item \textbf{Escalabilidade}: O MVC permite que o sistema se expanda de forma coesa, com cada camada sendo ampliada ou substituída sem impacto nas demais, essencial em sistemas que requerem evolução contínua.
\end{itemize}

\subsection{Desenvolvimento Backend Inicial e Adição de UI}

O desenvolvimento deste sistema começou com a implementação das camadas fundamentais, como \textit{Model}, \textit{Repository}, \textit{Service}, \textit{Utility} e \textit{Validation}. Estas camadas representam a lógica de negócios central e a persistência de dados, que são independentes da interface de utilizador. Iniciar com estas camadas permitiu que a lógica essencial fosse desenvolvida, testada e validada antes da introdução da interface visual.

Esta abordagem foi adotada com os seguintes benefícios:

\begin{itemize}
	\item \textbf{Foco na Lógica de Negócio}: Começar com a implementação das camadas de Model, Repository, Service e Validation permitiu concentrar esforços na criação e validação da lógica de negócios antes de adicionar a complexidade da interface de utilizador.
	
	\item \textbf{Testabilidade}: A ausência de uma interface de utilizador no início permitiu que as camadas de lógica fossem testadas de forma independente e unitária, garantindo que a interação entre elas funcionasse corretamente antes de integrar a UI.
	
	\item \textbf{Facilidade de Evolução}: Ao desenvolver a lógica de negócios separadamente da UI, foi possível garantir que o sistema estivesse bem estruturado e funcional antes de se preocupar com a apresentação visual. Isso permitiu que a interface fosse adicionada posteriormente de forma coesa, sem impactar as camadas já implementadas.
\end{itemize}

Depois de garantir que as camadas essenciais estavam a funcionar corretamente, a camada de View (UI) foi então integrada ao sistema. O Controller e a View passaram a interagir com as camadas de \textit{Model}, \textit{Repository} e \textit{Service}, proporcionando a interface de utilizador que permite aos utilizadores interagir com o sistema de maneira intuitiva.

Este processo progressivo de desenvolvimento inicial das camadas fundamentais, seguido pela implementação da interface de utilizador, proporcionou uma base sólida e escalável para o sistema.

\newpage
\section{Conclusão}
\label{sec:conclusion}

Lorem Ipsum.

%%% ===============================================================================
%%% Bibliography
%%% ===============================================================================

\renewcommand{\bibsection}{\section*{Referências}} % requried for natbib to have "References" printed and as section*, not chapter*
% Use natbib compatbile splncs04nat style.
% It does provide all features of splncs04.bst, but is developed in a clean way.
% Source: https://github.com/tpavlic/splncs04nat
\bibliographystyle{splncs04nat}
\begingroup
  \microtypecontext{expansion=sloppy}
  \small % ensure correct font size for the bibliography
  \bibliography{paper}
\endgroup

% Enfore empty line after bibliography
\ \\
%
Todas as ligações foram consultadas pela última vez no dia 15 de novembro de 2024.


%%% ===============================================================================
%\appendix
%\addcontentsline{toc}{chapter}{APPENDICES}

%\listoffigures
%\listoftables
%%% ===============================================================================

%%% ===============================================================================
%\section{My first appendix}\label{sec:appendix1}
%%% ===============================================================================
\end{document}
